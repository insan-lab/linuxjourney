---
index: 6
lang: "ja"
title: "カーネルモジュール"
meta_title: "カーネルモジュール - カーネル"
meta_description: "Linux におけるカーネルモジュールとは何か、そしてそれがカーネル機能をどのように拡張するかを発見してください。このレッスンでは、lsmod と modprobe を使用して、モジュールをオンデマンドで一覧表示、ロード、アンロードする方法を解説します。"
meta_keywords: "カーネルモジュールとは，Linux カーネルモジュール，modprobe, lsmod, カーネル管理，Linux チュートリアル，初心者 Linux, Linux ガイド"
---

## Lesson Content

Linux カーネルを車のコアエンジンだと考えてみてください。エンジン自体を変更することなく、ルーフラックや新しいサウンドシステムのようなアクセサリーを追加できます。これらのアクセサリーは必要に応じて追加または削除できます。Linux カーネルもカーネルモジュールで同様の概念を使用しています。

### カーネルモジュールとは何か

では、**カーネルモジュールとは何でしょうか**。これらは、必要に応じてカーネルにロードおよびアンロードできるコードの断片です。コアカーネルを再コンパイルしたりシステムを再起動したりすることなく、カーネルの機能を拡張します。このモジュール式のアプローチにより、新しいハードウェア（新しい Wi-Fi カードなど）や新しいソフトウェア機能（新しいファイルシステムなど）を動的に追加できるようになります。これにより、コアカーネルをスリムに保ちながら、計り知れない柔軟性を得ることができます。

### ロードされているモジュールのリスト表示

現在メモリにロードされているすべてのカーネルモジュールのリストを確認するには、`lsmod`コマンドを使用できます。これにより、アクティブなモジュールとその依存関係のスナップショットが得られます。

```bash
lsmod
```

### カーネルモジュールのロード

カーネルモジュールをロードするには、`modprobe`コマンドを使用します。たとえば、`bluetooth`モジュールをロードするには、次のように実行します。

```bash
sudo modprobe bluetooth
```

`modprobe`コマンドはインテリジェントです。標準ディレクトリ（`/lib/modules/$(uname -r)/`）でモジュールを検索し、ターゲットモジュールが依存する他のモジュールもロードします。

### カーネルモジュールのアンロード

モジュールが不要になった場合は、アンロードしてシステムリソースを解放できます。モジュールを削除するには、`modprobe`で`-r`フラグを使用します。

```bash
sudo modprobe -r bluetooth
```

### 起動時のモジュールの管理

`modprobe`でロードされたモジュールは一時的なものであり、再起動すると消えます。モジュールの設定を永続化するには、`/etc/modprobe.d/`ディレクトリに設定ファイルを作成できます。

起動時に特定のオプションでモジュールを自動的にロードするには、`.conf`ファイルを作成します。たとえば、`peanut_butter`という仮説のモジュールがあり、その`type`パラメータを`almond`に設定したい場合、ファイルは次のようになります。

```plaintext
# /etc/modprobe.d/peanutbutter.conf

options peanut_butter type=almond
```

逆に、起動時にモジュールがロードされないようにする（ブラックリスト化と呼ばれるプロセス）には、設定ファイルで`blacklist`キーワードを使用できます。

```plaintext
# /etc/modprobe.d/peanutbutter.conf

blacklist peanut_butter
```

これらの設定ファイルにより、システム起動時にどのモジュールが利用可能になるかを細かく制御できます。

## Exercise

練習あるのみです！Linux カーネルモジュールへの理解を深めるための実践的なラボを以下に示します。

1. **[Linux でカーネルモジュールを管理する](https://labex.io/ja/labs/comptia-manage-kernel-modules-in-linux-590865)** - カーネルモジュールのリスト表示、検査、ロード、アンロード、および起動時の自動ロードのための設定を練習します。このラボは、実際のシナリオで概念を適用し、カーネルモジュール管理への自信を築くのに役立ちます。

## Quiz Question

モジュールをアンロードするために使用されるコマンドは何ですか？

## Quiz Answer

modprobe -r
